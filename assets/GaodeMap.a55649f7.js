import{_ as O,f as T,j as I,I as x,a2 as U,R as N,o as j,c as L,a as c,S as Q,b as _,w as v,h as $,a3 as q,r as B,d as h,a4 as H,a5 as J}from"./app.dfa8e037.js";const E=()=>new Promise(function(l,m){if(typeof AMap!="undefined")return l(AMap),!0;const u=document.createElement("script");u.src="//webapi.amap.com/maps?v=1.4.15&key=d3b369f37bc25183a31cc7e3864000c6	",document.body.appendChild(u),setTimeout(()=>{AMap&&l(AMap)},3e3),u.load=()=>{console.log("script.onload"),l(AMap)}});const P=l=>(H("data-v-5f411426"),l=l(),J(),l),K={class:"map"},W=h("\u5730\u56FE\u9009\u70B9"),X=P(()=>c("div",{id:"container"},null,-1)),Y=P(()=>c("div",{id:"pickerBox"},[c("input",{id:"pickerInput",placeholder:"\u8F93\u5165\u5173\u952E\u5B57\u9009\u53D6\u5730\u70B9"}),c("div",{id:"poiInfo"})],-1)),Z={class:"dialog-footer"},ee=h("\u53D6\u6D88"),te=h("\u786E\u5B9A"),oe=T({__name:"GaodeMap",props:["visible","lonlat","mapOption"],emits:["update:visible","update:lonlat","getAddress"],setup(l,{emit:m}){const u=l,i=I({get:()=>u.visible,set:e=>m("update:visible",e)}),o=I({get:()=>u.lonlat,set:e=>m("update:lonlat",e)});let s=null,a=null,g=[],d=null;const G=window.AMapUI,A=x(""),r=x(""),V=async()=>{if(a=await E(),s=new a.Map("container",{zoom:18,viewMode:"3D",center:o.value||[120.5644,27.6025],pitch:50,rotation:35,resizeEnable:!0}),d=new a.Marker,s.plugin(["AMap.ToolBar","AMap.Scale","AMap.OverView","AMap.Geocoder"],()=>{s.addControl(new a.ToolBar),s.addControl(new a.Scale),s.addControl(new a.OverView),A.value=new a.Geocoder({radius:1e3})}),G.loadUI(["misc/PoiPicker"],function(t){var n=new t({input:"pickerInput"});S(n)}),o.value&&o.value.length>0){const t={Q:o.value[1],R:o.value[0],lng:o.value[0],lat:o.value[1]};w(t),k(o.value)}D()},S=e=>{window.poiPicker=e,e.on("poiPicked",function(t){const n=t.item;w(n.location),r.value=n.address||n.name,d.setLabel({offset:new a.Pixel(1,0),content:r.value,direction:"top"})}),e.onCityReady(function(){e.suggest("\u7F8E\u98DF")})},D=()=>{s.on("click",e=>{const t={Q:e.lnglat.lat,R:e.lnglat.lng,lng:e.lnglat.lng,lat:e.lnglat.lat};w(t),k(g)})},w=e=>{s.remove(d),d.setMap(s),d.setPosition(e),s.setCenter(d.getPosition()),g=[e.lng,e.lat]},k=e=>{A.value.getAddress(e,(t,n)=>{t==="complete"&&n.regeocode&&(r.value=n.regeocode.formattedAddress,d.setLabel({offset:new a.Pixel(1,0),content:r.value,direction:"top"}))})};let f=null,p=null;const y=async()=>{a=await E(),p=new a.Marker,f=new a.Map("container-mini",{zoom:18,viewMode:"3D",center:o.value||[120.5644,27.6025],pitch:50,rotation:35,resizeEnable:!0}),o.value&&o.value.length>0&&(f.remove(p),p.setMap(f),p.setPosition([o.value[0],o.value[1]]),f.setCenter(p.getPosition()))};U(()=>{i.value&&V(),o.value&&y()}),N(()=>{y()});const R=()=>{o.value=g,i.value=!1,m("getAddress",r.value)},z=()=>{s.destroy()};return(e,t)=>{var b,C;const n=B("el-button"),F=B("el-dialog");return j(),L("div",K,[c("div",{id:"container-mini",style:Q({height:((b=l.mapOption)==null?void 0:b.height)||"150px",width:((C=l.mapOption)==null?void 0:C.width)||"150px"})},null,4),_(n,{onClick:t[0]||(t[0]=M=>i.value=!0)},{default:v(()=>[W]),_:1}),_(F,{top:"10%",width:"62%",modelValue:$(i),"onUpdate:modelValue":t[2]||(t[2]=M=>q(i)?i.value=M:null),"show-close":!1,"custom-class":"dialog_style",title:"\u5730\u56FE\u9009\u70B9",onClose:z,"destroy-on-close":!0},{footer:v(()=>[c("span",Z,[_(n,{onClick:t[1]||(t[1]=M=>i.value=!1)},{default:v(()=>[ee]),_:1}),_(n,{type:"primary",onClick:R},{default:v(()=>[te]),_:1})])]),default:v(()=>[X,Y]),_:1},8,["modelValue"])])}}});var ne=O(oe,[["__scopeId","data-v-5f411426"],["__file","GaodeMap.vue"]]);export{ne as default};
